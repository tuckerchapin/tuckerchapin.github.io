name: Issue to HTML

on:
  push:
    paths:
      - issues/*.json

jobs:
  issue-to-html-job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Run node
        run: node dist/index.js
      # - name: Dump issue to JSON
      #   id: dump-issue
      #   uses: actions/github-script@v7
      #   with:
      #     github-token: ${{secrets.GITHUB_TOKEN}}
      #     script: |
      #       const path = `issues/`;
      #       const fs = require('fs');
      #       if (!fs.existsSync()) fs.mkdirSync(path, { recursive: true });
      #       fs.writeFileSync(`${path}${context.issue.number}.json`, JSON.stringify(context.payload.issue, null, 2));

      #       const formattedChanges = context.payload.changes ? ' ' + Object.keys(context.payload.changes).reduce((a, c, i, arr) => { if (i === 0) return c; if (i === arr.length - 1) return `${a} & ${c}`; return `${a}, ${c}`;}, '') : '';
      #       return `Issue sync: ${context.payload.action} issue #${context.issue.number}${formattedChanges}`;
      #     result-encoding: string

      # - name: Commit and push
      #   run: |
      #     git config --local user.email "action@github.com"
      #     git config --local user.name "Issue to Post"
      #     git add .
      #     git commit -m "${{ steps.dump-issue.outputs.result }}"
      #     git push
